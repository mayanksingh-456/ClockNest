

<div class="modal fade right" id="tagModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-xl modal-right" style="width:40vw">
        <div class="modal-content h-100 border-0">

            <EditForm Model="@createEditTagModel" OnSubmit="HandelValidSubmit" class="d-flex flex-column h-100">
                <DataAnnotationsValidator />

                <!-- Header-->
                <div class="modal-header border-0">
                    <h5> @((createEditTagModel.Id == 0) ? "Create Tag" : "Edit Tag") </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Body-->
                <div class="modal-body overflow-auto flex-grow-1" style="max-height: 90vh; margin-top: -15px;">

                    <div class="mb-3">
                        <label class="form-label body-medium">Name <span class="text-danger">*</span></label>
                        <InputText class="form-control form-control-lg body-medium no-outline"
                                   @bind-Value="createEditTagModel.Name" placeholder="Name" />
                        <ValidationMessage For="@(() => createEditTagModel.Name)" />
                    </div>

                   
                    <div class="mb-3">
                        <label class="form-label body-medium">Description </label>
                        <InputText class="form-control form-control-lg body-medium  no-outline"
                                   @bind-Value="createEditTagModel.Description" placeholder="Description" />
                    </div>

                    <div class="mb-3">
                        <label class="form-label body-medium">Budget plan</label>
                        <InputSelect TValue="int?" @bind-Value="createEditTagModel.BudgetPlanId" class="form-select form-control-lg body-medium  no-outline">
                           
                            @foreach (var budget in createEditTagModel.BudgetPlans)
                            {
                                <option value="@budget.Value">@budget.Text</option>
                            }
                        </InputSelect>
                    </div>

                    <div class="mb-3">
                        <label class="form-label body-medium">Holiday threshold</label>
                        <InputSelect TValue="int?" @bind-Value="createEditTagModel.HolidayThresholdId" class="form-select form-control-lg body-medium  no-outline">

                            @foreach (var holiday in createEditTagModel.HolidayThresholds)
                            {
                                <option value="@holiday.Value">@holiday.Text</option>
                            }
                        </InputSelect>
                    </div>

                    <div class="mb-3">
                        <label class="form-label body-medium">Sequence </label>
                        <InputNumber class="form-control form-control-lg body-medium  no-outline"
                                     @bind-Value="createEditTagModel.Sequence" placeholder="Sequence" />
                    </div>

                    <div class="mb-2 pt-1 form-check form-switch d-flex align-items-center">
                        <input type="checkbox" class="form-check-input me-2" @bind="createEditTagModel.IsForVisitorModule" />
                        <label class="form-label body-medium mb-0"> Apply to Visitor Module </label>
                    </div>

                    <div class="mb-2 pt-1 form-check form-switch d-flex align-items-center">
                        <input type="checkbox" class="form-check-input me-2" @bind="createEditTagModel.Archived" />
                        <label class="form-label body-medium mb-0"> Archived </label>
                    </div>

                   


                </div>
                <!-- Footer-->
                <div class="modal-footer bg-white mt-auto" style="padding-top: 1rem;">
                    <button type="button" class="btn_modal-close body-medium" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit"
                            class="btn_modal-success_save title-h4-semi-bold"
                            disabled="@isSubmitting"
                            style="@(isSubmitting ? "opacity: 0.6; pointer-events: none;" : null)">
                        @if (isSubmitting)
                        {
                            <span><i class="spinner-border spinner-border-sm me-1"></i> Saving...</span>
                        }
                        else
                        {
                            <span>Save</span>
                        }
                    </button>
                </div>

            </EditForm>
        </div>
    </div>
</div>

@code {


    [Parameter] public bool isSubmitting { get; set; }
    [Parameter] public CreateEditTagViewModel createEditTagModel { get; set; } = new();
    [Parameter] public EventCallback<CreateEditTagViewModel> OnSubmit { get; set; }

    public async Task ShowModal(CreateEditTagViewModel model)
    {
        createEditTagModel = model;
        await JS.InvokeVoidAsync("showModal", "tagModal");
        StateHasChanged();
    }

    public async Task HandelValidSubmit()
    {
        await OnSubmit.InvokeAsync(createEditTagModel);
    }
}
